{% extends 'layout.html' %} {% block nav %}
<ul class="nav nav-pills nav-fill">
  {% if role == 1 %}
  <li class="nav-item">
    <a class="nav-link" href="{{ url_for('attendance') }}">Attendance</a>
  </li>
  <li class="nav-item">
    <a class="nav-link active" href="{{ url_for('assignment') }}">Assignment</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="{{ url_for('timetable') }}">Time Table</a>
  </li>
  {% else %}
  <li class="nav-item">
    <a class="nav-link active" href="{{ url_for('lec_attendance') }}"
      >Lec Attendance</a
    >
  </li>
  <li class="nav-item">
    <a class="nav-link" href="{{ url_for('lec_assignment') }}"
      >Lec Assignment</a
    >
  </li>
  <li class="nav-item">
    <a class="nav-link" href="{{ url_for('lec_timetable') }}">Lec Timetable</a>
  </li>
  {% endif %}
</ul>
{% endblock %} {% block content %}
<style>
  .table-wrap {
    overflow-x: scroll;
  }
  table {
    border-collapse: collapse;
    width: 100%;
    margin-bottom: 1rem;
    color: #212529;
    background: #fff;
    -webkit-box-shadow: 0px 5px 12px -12px rgba(0, 0, 0, 0.29);
    -moz-box-shadow: 0px 5px 12px -12px rgba(0, 0, 0, 0.29);
    box-shadow: 0px 5px 12px -12px rgba(0, 0, 0, 0.29);
  }
  .table-wrap::-webkit-scrollbar {
    display: none;
  }
  th {
    text-align: inherit;
  }
  .table thead.thead-primary {
    background: #80c3d6;
  }
  .table tbody th,
  .table tbody td {
    border: none;
    padding: 15px;
    font-size: 15px;
    background: #fff;
    border-bottom: 4px solid #f8f9fd;
    vertical-align: middle;
  }
  .table thead th {
    border: none;
    padding: 28px;
    font-size: 15px;
    font-weight: 700;
    color: white;
  }
</style>
<div class="container">
  <section style="padding: 5px">
    <h3 class="my-0 mr-md-auto font-weight-normal font-weight-bold">
      Student's Assignment
    </h3>
    <em
      >Students are able to submit and check their course assignment status
      here.</em
    >
  </section>

  {% if error %} 
  <div class="alert alert-danger" role="alert">{{ error }}</div>   <!-- this is the red box "Invalid Credentials" -->
  {% endif %}

  <div class="card w-100">
    <div class="card-body">
      <div class="row">
        <div class="col-md-12">
          <div class="table-wrap">
            <table class="table">
              <thead class="thead-primary">
                <tr>
                  <th>Subject</th>
                  <th>Assignment Name</th>
                  <th>Due Date</th>
                  <th>Status</th>
                  <th>Submission</th>
                </tr>
              </thead>
              <tbody>
                {% for item in studentAssignment %}
                <tr class="alert" role="alert">
                  <td>{{item[0]}}</td>
                  <td>{{item[1]}}</td>
                  <td>{{item[2]}}</td>
                  {% if item[3] == 1 %}
                  <td>Pending</td>
                  <td>
                    <button
                      type="button"
                      class="btn btn-outline-info submit-assignment-btn"
                      data-toggle="modal"
                      data-target="#exampleModalCenter"
                      data-id="{{item[4]}}"
                    >
                      Submit
                    </button>
                  </td>
                  {% elif item[3] == 2 %}
                  <td>Submitted</td>
                  <td>-</td> <!--to prevent double submission-->
                  {% elif item[3] == 3 %}
                  <td>Late Submit</td>
                  <td>-</td>
                  {% elif item[3] == 4 %}
                  <td>Pass</td>
                  <td>-</td>
                  {% elif item[3] == 5 %}
                  <td>Fail</td>
                  <td>-</td>
                  {% else %}
                  <td>Pending</td>
                  <td>
                    <button
                      type="button"
                      class="btn btn-outline-info submit-assignment-btn"
                      data-toggle="modal"
                      data-target="#exampleModalCenter"
                      data-id="{{item[4]}}"
                    >
                      Submit
                    </button>
                  </td>
                  {% endif %}
                  
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- Modal Popup -->
<div
  class="modal fade"
  id="exampleModalCenter"
  tabindex="-1"
  role="dialog"
  aria-labelledby="exampleModalCenterTitle"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLongTitle">
          Please Submit Assignment
        </h5>
        <button
          type="button"
          class="close"
          data-dismiss="modal"
          aria-label="Close"
        >
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <form action="/assignmentURL" method="POST">
        <div class="modal-body">
          <input
            type="text"
            id="assignmentLink"
            name="assignmentLink"
            class="form-control mb-2"
            placeholder="Enter URL..."
          />
          <input
            type="hidden"
            id="assignmentIDForm"
            name="assignmentID"
            class="form-control mb-2"
          />
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">
            Close
          </button>
          <button type="submit" class="btn btn-success">
            Submit Assignment
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
   $(".submit-assignment-btn").on("click", function (event) {
    var id = $(this).data("id");
    $("#assignmentIDForm").val("");
    $("#assignmentIDForm").val(id);
  });
</script>
{% endblock %}